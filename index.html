<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINHMODLAG V200 | H·ªÜ TH·ªêNG T·ªîNG H·ª¢P</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --main: #ff2d8d; 
            --bg: #0f172a; 
            --card: #1e293b; 
            --text: #f8fafc; 
            --border: rgba(255, 255, 255, 0.1); 
            --admin: #00ff88; 
            --total: #00e1ff;
            --sold: #ffbc00;
        }

        /* --- CSS N·ªÄN T·∫¢NG --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Lexend', sans-serif; transition: 0.3s; }
        body { background: var(--bg); color: var(--text); overflow-x: hidden; }

        /* --- HEADER & WALLET --- */
        header { 
            height: 75px; background: var(--card); display: flex; align-items: center; 
            justify-content: space-between; padding: 0 25px; border-bottom: 3px solid var(--main); 
            position: sticky; top: 0; z-index: 1000; 
        }
        .wallet { 
            background: rgba(255,45,141,0.1); padding: 8px 15px; border-radius: 12px; 
            color: var(--main); font-weight: bold; border: 1px solid var(--main); 
        }

        /* --- M√ÄN H√åNH CH·ªú (LOGIN) --- */
        #authScreen { 
            position: fixed; inset: 0; background: var(--bg); z-index: 10000; 
            display: flex; align-items: center; justify-content: center; padding: 20px; 
        }
        .auth-box { 
            background: var(--card); padding: 40px; border-radius: 30px; width: 100%; 
            max-width: 400px; border: 1px solid var(--border); text-align: center; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
        }

        /* --- DANH S√ÅCH S·∫¢N PH·∫®M --- */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; }
        .p-card { 
            background: var(--card); border-radius: 25px; padding: 25px; 
            border: 1px solid var(--border); border-top: 5px solid var(--main); 
        }
        .p-name { font-size: 20px; font-weight: 900; color: var(--main); margin-bottom: 15px; text-transform: uppercase; }

        /* --- 3 LO·∫†I TH·ªêNG K√ä KHO --- */
        .stock-table { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px; text-align: center; }
        .stock-box { background: rgba(0,0,0,0.2); padding: 10px 5px; border-radius: 12px; border: 1px solid var(--border); }
        .stock-label { font-size: 9px; opacity: 0.6; margin-bottom: 4px; font-weight: bold; }
        .stock-value { font-size: 15px; font-weight: 900; }

        /* --- MENU B√äN TR√ÅI --- */
        #menu { 
            position: fixed; top: 0; left: -420px; width: 380px; height: 100%; 
            background: var(--card); z-index: 2000; padding: 25px; overflow-y: auto; 
            border-right: 3px solid var(--main); box-shadow: 10px 0 50px rgba(0,0,0,0.5); 
        }
        .section { background: rgba(0,0,0,0.2); border-radius: 20px; padding: 15px; margin-bottom: 15px; border: 1px solid var(--border); }
        .section-title { font-size: 11px; font-weight: 900; color: var(--main); margin-bottom: 10px; text-transform: uppercase; }

        /* --- INPUTS & BUTTONS --- */
        input, select, button { 
            width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; 
            border: 1px solid var(--border); background: var(--bg); color: var(--text); outline: none; 
        }
        .btn-main { background: var(--main); border: none; font-weight: 900; cursor: pointer; color: white; text-transform: uppercase; }
        .btn-logout { background: none; border: 1px solid #ff4757; color: #ff4757; margin-top: 20px; cursor: pointer; }

        /* --- MODAL HI·ªÜN KEY --- */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 5000; align-items: center; justify-content: center; }
        #overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 1500; }
    </style>
</head>
<body>

    <div id="authScreen">
        <div class="auth-box">
            <h1 style="color:var(--main); margin-bottom: 10px;">VINHMOD</h1>
            <p id="authStatus" style="font-size: 12px; opacity: 0.6; margin-bottom: 20px;">ƒêƒÇNG NH·∫¨P HO·∫∂C ƒêƒÇNG K√ù</p>
            <input type="text" id="userIn" placeholder="T√™n t√†i kho·∫£n...">
            <input type="password" id="passIn" placeholder="M·∫≠t kh·∫©u...">
            <button class="btn-main" onclick="handleAuth()">V√ÄO C·ª¨A H√ÄNG</button>
            <p onclick="switchAuth()" id="switchText" style="margin-top:20px; font-size:12px; cursor:pointer;">Ch∆∞a c√≥ nick? <b style="color:var(--main)">ƒêƒÉng k√Ω ngay</b></p>
        </div>
    </div>

    <div id="app" style="display:none">
        <header>
            <div onclick="toggleMenu(true)" style="font-size:25px; cursor:pointer; color:var(--main)">‚ò∞</div>
            <div style="font-weight:900; letter-spacing:1px;">VINHMODLAG</div>
            <div class="wallet">üí∞ <span id="balanceDisp">0</span>ƒë</div>
        </header>

        <div id="menu">
            <h3 style="color:var(--main)">S·∫øp: <span id="userDisp"></span></h3>
            <hr style="opacity:0.1; margin: 15px 0;">

            <div id="adminPanel" style="display:none">
                <div class="section" style="border-color: var(--admin)">
                    <div class="section-title" style="color: var(--admin)">üì¢ TH√îNG B√ÅO N·∫†P TH·∫∫</div>
                    <div id="adminNotiList" style="font-size:10px; max-height:100px; overflow-y:auto;"></div>
                    <button onclick="clearNotis()" style="font-size:9px; background:none; color:gray; cursor:pointer;">X√≥a l·ªãch s·ª≠</button>
                </div>
                <div class="section" style="border-color: #0068ff">
                    <div class="section-title" style="color: #0068ff">üõ† QU·∫¢N TR·ªä KHO & V√ç</div>
                    <select id="admProdId"></select>
                    <input id="admKey" placeholder="Nh·∫≠p Key/Acc...">
                    <button class="btn-main" style="background:#0068ff" onclick="addStock()">N·∫†P KHO</button>
                    <hr style="opacity:0.1; margin:10px 0">
                    <input id="admUser" placeholder="T√™n kh√°ch...">
                    <input type="number" id="admAmount" placeholder="S·ªë ti·ªÅn c·ªông...">
                    <button class="btn-main" style="background:var(--admin); color:#000" onclick="addMoney()">C·ªòNG TI·ªÄN</button>
                </div>
            </div>

            <div class="section">
                <div class="section-title">üí≥ N·∫†P TI·ªÄN V√ÄO V√ç</div>
                <select onchange="swPay(this.value)">
                    <option value="momo">V√≠ MoMo (T·ª± ƒë·ªông)</option>
                    <option value="card">Th·∫ª C√†o (Duy·ªát tay)</option>
                </select>
                <div id="momoPay">
                    <input type="number" id="momoAmt" placeholder="Nh·∫≠p s·ªë ti·ªÅn...">
                    <button class="btn-main" style="background:#a50064" onclick="genQR()">T·∫†O QR</button>
                    <div id="qrArea" style="display:none; background:white; padding:10px; margin-top:10px; border-radius:10px; text-align:center;">
                        <img id="qrImg" style="width:100%"><p style="color:black; font-size:10px;">N·ªôi dung: <b id="qrMsg" style="color:#a50064"></b></p>
                    </div>
                </div>
                <div id="cardPay" style="display:none">
                    <select id="cType"><option>Viettel</option><option>Mobifone</option><option>Zing</option><option>Garena</option></select>
                    <select id="cVal"><option>10.000ƒë</option><option>20.000ƒë</option><option>50.000ƒë</option><option>100.000ƒë</option><option>500.000ƒë</option></select>
                    <input id="cPin" placeholder="M√£ th·∫ª (PIN)..."><input id="cSeri" placeholder="S·ªë Seri...">
                    <button id="btnSend" class="btn-main" onclick="sendCard()">G·ª¨I TH·∫∫</button>
                </div>
            </div>

            <div class="section">
                <div class="section-title">üìã KHO ƒê·ªí ƒê√É MUA</div>
                <div id="historyList" style="font-size:11px;"></div>
            </div>

            <button class="btn-logout" onclick="logout()">ƒêƒÇNG XU·∫§T</button>
        </div>

        <div class="container"><div class="grid" id="shopGrid"></div></div>
    </div>

    <div id="keyModal" class="modal">
        <div class="auth-box" style="border: 2px solid var(--main)">
            <h2 style="color:var(--main)">GIAO D·ªäCH XONG</h2>
            <div id="keyResult" style="background:black; color:var(--main); padding:20px; margin:20px 0; border-radius:10px; word-break:break-all; font-family:monospace;"></div>
            <button class="btn-main" onclick="copyKey()">SAO CH√âP</button>
            <button onclick="document.getElementById('keyModal').style.display='none'" style="margin-top:15px; cursor:pointer; background:none; border:none; color:gray;">ƒê√ìNG</button>
        </div>
    </div>

    <div id="overlay" onclick="toggleMenu(false)"></div>

    <script>
        // --- D·ªÆ LI·ªÜU & KH·ªûI T·∫†O ---
        const DB = 'VINHMOD_FINAL_DB';
        const SS = 'VINHMOD_FINAL_SS';
        let isLogin = true;

        let data = JSON.parse(localStorage.getItem(DB)) || {
            users: { "vinhmoddz": { p: "123", b: 1000000, admin: true, buys: [] } },
            prods: [
                { id: 0, name: "Acc Clone Lv 5", plans: {"M·∫∑c ƒë·ªãnh": 5000}, stock: {"M·∫∑c ƒë·ªãnh": []}, sold: 0, total: 0 },
                { id: 1, name: "Itachi Ping V3", plans: {"1 Ng√†y": 10000, "Vƒ©nh Vi·ªÖn": 500000}, stock: {"1 Ng√†y": [], "Vƒ©nh Vi·ªÖn": []}, sold: 0, total: 0 },
                { id: 2, name: "Hopper Plus", plans: {"7 Ng√†y": 50000, "30 Ng√†y": 150000}, stock: {"7 Ng√†y": [], "30 Ng√†y": []}, sold: 0, total: 0 }
            ],
            notis: []
        };

        let user = localStorage.getItem(SS);

        // --- C∆† CH·∫æ AUTO-SAVE ---
        function save() { 
            localStorage.setItem(DB, JSON.stringify(data)); 
            if(user) renderAll(); 
        }

        // --- H·ªÜ TH·ªêNG AUTH ---
        function switchAuth() { 
            isLogin = !isLogin; 
            document.getElementById('authStatus').innerText = isLogin ? "ƒêƒÇNG NH·∫¨P" : "ƒêƒÇNG K√ù T√ÄI KHO·∫¢N";
            document.getElementById('switchText').innerHTML = isLogin ? 'Ch∆∞a c√≥ nick? <b style="color:var(--main)">ƒêƒÉng k√Ω ngay</b>' : 'ƒê√£ c√≥ nick? <b style="color:var(--main)">ƒêƒÉng nh·∫≠p</b>';
        }

        function handleAuth() {
            let u = document.getElementById('userIn').value.trim(), p = document.getElementById('passIn').value.trim();
            if(!u || !p) return alert("Nh·∫≠p ƒë·ªß th√¥ng tin s·∫øp ∆°i!");
            if(isLogin) {
                if(data.users[u] && data.users[u].p === p) { user = u; localStorage.setItem(SS, u); renderAll(); }
                else alert("Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!");
            } else {
                if(data.users[u]) return alert("T√™n n√†y c√≥ ng∆∞·ªùi l·∫•y r·ªìi!");
                data.users[u] = { p: p, b: 0, admin: (u === "vinhmoddz"), buys: [] };
                save(); alert("ƒêƒÉng k√Ω th√†nh c√¥ng! M·ªùi s·∫øp ƒëƒÉng nh·∫≠p."); isLogin = true; switchAuth();
            }
        }

        // --- HI·ªÇN TH·ªä GIAO DI·ªÜN ---
        function renderAll() {
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            document.getElementById('userDisp').innerText = user;
            document.getElementById('balanceDisp').innerText = data.users[user].b.toLocaleString();

            if(data.users[user].admin) {
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('admProdId').innerHTML = data.prods.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
                document.getElementById('adminNotiList').innerHTML = data.notis.map(n => `<div style="padding:5px 0; border-bottom:1px solid #333;">[${n.t}] <b>${n.u}</b>: ${n.type} ${n.val}<br>${n.pin} | ${n.seri}</div>`).join('');
            }

            let html = "";
            data.prods.forEach(p => {
                let rem = Object.values(p.stock).reduce((a,b)=>a+b.length, 0);
                html += `
                    <div class="p-card">
                        <div class="p-name">${p.name}</div>
                        <div class="stock-table">
                            <div class="stock-box"><div class="stock-label">T·ªïng h√†ng</div><div class="stock-value" style="color:var(--total)">${p.total}</div></div>
                            <div class="stock-box"><div class="stock-label">ƒê√£ b√°n</div><div class="stock-value" style="color:var(--sold)">${p.sold}</div></div>
                            <div class="stock-box"><div class="stock-label">C√≤n l·∫°i</div><div class="stock-value" style="color:var(--admin)">${rem}</div></div>
                        </div>
                        <select id="sel-${p.id}">${Object.keys(p.plans).map(k=>`<option value="${k}">${k} - ${p.plans[k].toLocaleString()}ƒë</option>`).join('')}</select>
                        <button class="btn-main" onclick="buy(${p.id})">MUA NGAY</button>
                    </div>`;
            });
            document.getElementById('shopGrid').innerHTML = html;
            document.getElementById('historyList').innerHTML = data.users[user].buys.map((b,i) => `<div style="display:flex; justify-content:space-between; margin-bottom:10px; border-bottom:1px solid #333; padding-bottom:5px;"><div><b>${b.n}</b><br><small>${b.p}</small></div><button onclick="viewKey(${i})" style="width:50px; font-size:9px; background:var(--main); border:none; border-radius:5px; color:white; cursor:pointer;">XEM</button></div>`).join('');
        }

        // --- CH·ª®C NƒÇNG MUA & N·∫†P ---
        function buy(id) {
            let p = data.prods[id], plan = document.getElementById(`sel-${id}`).value;
            if(data.users[user].b < p.plans[plan]) return alert("S·∫øp thi·∫øu ti·ªÅn r·ªìi!");
            if(p.stock[plan].length == 0) return alert("H·∫øt h√†ng r·ªìi s·∫øp!");
            let key = p.stock[plan].shift();
            data.users[user].b -= p.plans[plan]; p.sold++;
            data.users[user].buys.unshift({n: p.name, p: plan, k: key});
            save(); document.getElementById('keyResult').innerText = key; document.getElementById('keyModal').style.display = 'flex';
        }

        function sendCard() {
            let t = document.getElementById('cType').value, v = document.getElementById('cVal').value, p = document.getElementById('cPin').value, s = document.getElementById('cSeri').value;
            if(!p || !s) return alert("Nh·∫≠p ƒë·ªß PIN/Seri!");
            data.notis.unshift({ t: new Date().toLocaleTimeString(), u: user, type: t, val: v, pin: p, seri: s });
            document.getElementById('btnSend').innerText = "ƒêANG ƒê·ª¢I DUY·ªÜT..."; document.getElementById('btnSend').disabled = true;
            save(); alert("ƒê√£ g·ª≠i th·∫ª cho Admin!");
        }

        function genQR() {
            let a = document.getElementById('momoAmt').value; if(!a) return alert("Nh·∫≠p s·ªë ti·ªÅn!");
            document.getElementById('qrMsg').innerText = "NAP " + user;
            document.getElementById('qrImg').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=2|99|0364684151|||0|0|${a}|NAP%20${user}|transfer_p2p`;
            document.getElementById('qrArea').style.display = 'block';
        }

        // --- H√ÄM ADMIN ---
        function addStock() {
            let id = document.getElementById('admProdId').value, k = document.getElementById('admKey').value;
            if(!k) return;
            let planName = Object.keys(data.prods[id].stock)[0];
            data.prods[id].stock[planName].push(k);
            data.prods[id].total++; // TƒÉng t·ªïng h√†ng ƒë√£ n·∫°p
            save(); document.getElementById('admKey').value=""; alert("N·∫°p kho th√†nh c√¥ng!");
        }

        function addMoney() {
            let u = document.getElementById('admUser').value, a = parseInt(document.getElementById('admAmount').value);
            if(data.users[u]) { data.users[u].b += a; save(); alert("ƒê√£ c·ªông ti·ªÅn xong!"); }
            else alert("Kh√¥ng t√¨m th·∫•y kh√°ch n√†y!");
        }

        // --- TI·ªÜN √çCH ---
        function toggleMenu(s) { document.getElementById('menu').style.left = s ? '0' : '-420px'; document.getElementById('overlay').style.display = s ? 'block' : 'none'; }
        function swPay(v) { document.getElementById('momoPay').style.display=(v=='momo'?'block':'none'); document.getElementById('cardPay').style.display=(v=='card'?'block':'none'); }
        function logout() { localStorage.removeItem(SS); location.reload(); }
        function viewKey(i) { document.getElementById('keyResult').innerText = data.users[user].buys[i].k; document.getElementById('keyModal').style.display = 'flex'; }
        function copyKey() { navigator.clipboard.writeText(document.getElementById('keyResult').innerText); alert("ƒê√£ copy!"); }
        function clearNotis() { data.notis = []; save(); }

        window.onbeforeunload = save;
        if(user && data.users[user]) renderAll();
    </script>
</body>
  </html>
          
